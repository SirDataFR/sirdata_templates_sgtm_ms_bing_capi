___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "sirdata_templates_sgtm_ms_bing_capi",
  "version": 1.0,
  "securityGroups": [],
  "displayName": "GDPR Ready Bing/Microsoft Ads Conversions by Sirdata",
  "categories": [
    "ADVERTISING",
    "ANALYTICS",
    "ATTRIBUTION",
    "CONVERSIONS",
    "MARKETING",
    "REMARKETING"
  ],
  "brand": {
    "id": "sirdata",
    "displayName": "Sirdata",
    "thumbnail": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAeAB4AAD/4QKcRXhpZgAATU0AKgAAAAgABAE7AAIAAAAOAAABSodpAAQAAAABAAABWJydAAEAAAAcAAACeOocAAcAAAEMAAAAPgAAAAAc6gAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQmVub2l0IE9CRVJMRQAAAeocAAcAAAEMAAABagAAAAAc6gAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABCAGUAbgBvAGkAdAAgAE8AQgBFAFIATABFAAAA/+EDZmh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iLz48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+PGRjOmNyZWF0b3I+PHJkZjpTZXEgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj48cmRmOmxpPkJlbm9pdCBPQkVSTEU8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PC9yZGY6UkRGPjwveDp4bXBtZXRhPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9J3cnPz7/2wBDAAcFBQYFBAcGBQYIBwcIChELCgkJChUPEAwRGBUaGRgVGBcbHichGx0lHRcYIi4iJSgpKywrGiAvMy8qMicqKyr/2wBDAQcICAoJChQLCxQqHBgcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKir/wAARCAHMAd0DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD6QooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKSiigAopM0ZoFcWim5ozSC46im5ozQFx1LTc0ZpgOopKWgYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABSUGkoEFJmjNNJpEtik0mailmjhXdM6xr/edgB+tVzqliOt9bf9/0/wAahysQ5WLu6kzVL+1LH/n+tv8Av+n+NJ/alj/z+2v/AH/T/GlzIn2iL26l3VQ/tSx/5/rX/v8Ap/jR/ath/wA/1r/3/T/GjmQe0RfBp2aopqVm7BUvLdiegEykn9atBs1SdylK5LS0wGnCqNEOopKWmUFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFACGkpaaaQmIaq392tjYXF1IMpBE0jD1Cgn+lWTWJ4sP/FIat/15yfyrOpK0WznqycYNroeKahf3Wr3bXepSNPM/J3nIXPZR0AHtVTYn9xf++RTzTTXxbfM7vc/OJSc3zS1bGmOP+4v/fIpPLj/AOea/wDfIp1FKyFZDfLj/wCea/8AfIo2J/cX/vkUtFFkOyE2IeqKf+AivQ/hhrs4vpNFnlZ4GiMtuGOfLKkblHsQc47Y9689rpPABx44sMHqJR/5DNdeDk4V426u33ndl9SVPEw5ert957aDTxUSVIK+tR97Fj6WminVRoFFFFAwooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigBKaadTTSJYxqxfFn/ACKOrf8AXpJ/KtpqxPFn/Io6t/15yfyrGr8D9DlxH8OXozw49abTm602vjD85G0UtJQUJRRRTGFdJ4A/5Hiw+kv/AKLaubrpPAH/ACPFh9Jf/RbVvh/40PVfmdWD/wB5p+q/M9rTpUgqJKlFfXxPv47DhS0gp1WahRRRQMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooASmmnGmmkSxjVieLP8AkUdW/wCvOT+VbbVieLP+RR1b/rzk/lWFX4H6HLiP4cvRnhx602nHrTa+NPzkQ0lKaQ0DEoopKZQtdJ4A/wCR5sPpL/6LaubrpPh//wAjxYfSX/0W1b4f+ND1X5nVg/8AeafqvzPak6VKKiTpUor66J9/AcKUUgpa0NULRRRQMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigApKWkoAQ0008000iWMasTxZ/yKOrf9ecn8q22rE8Wf8ijq3/XnJ/KsKvwP0OTEfw5ejPDj1ptOPWm18afnQhpKKQ0FBSUGkplC10ngD/keLD6S/8Aotq5uuk8Af8AI82H0l/9FtW+H/jQ9V+Z04P/AHin6r8z2tOlSiok6VKK+uiffQHClpBS1obC0UUUDCiiigAooooAKKKK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ZeIWPzCxj9zcZ/ktXrf4U6i//H1qVnEP+maPIf1216rspdlJZdQW6v8AMI5Rhlum/n/lY4Kz+FemRc319d3J9E2xL+mT+tdJp3hXRdLYNZabAkg/5aMu9/8AvpsmtkLSha6oYalD4Yo7KeDo0vgikMCZPPP1pwWn4pQK6LHWoiAUuKXFLimWkJS0tFMoKWiimMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooASjFLRQAlJS0UCExRilxRSCwmKKWimAYopaSgAooooATFGKWjFILDcUmKfijFArDMUYp2KMUWCw3FGKdilxRYLDcUYpcUuKAsJiilxRigYUUtFMYlLRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUYooAKKKKACiiigAooooAKKKKACiiigBMUtFFABSUtFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUGigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKDwCaoSX0iPgKmPpQBfoqKCQyplsA+1S0AFFFFABRRRQB//9k\u003d"
  },
  "description": "Server-side tag for transmitting conversions and events to Bing/Microsoft Ads, featuring integrated GDPR and consent management controls.",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "LABEL",
    "name": "label1",
    "displayName": "All fields with star (*) are required."
  },
  {
    "type": "TEXT",
    "name": "tag_id",
    "displayName": "UET Tag ID*",
    "simpleValueType": true,
    "canBeEmptyString": false,
    "help": "If you already load MS SDK in user\u0027s browser, unactivate it or use a different UET Tag Id here, to avoid duplicate tracking.",
    "alwaysInSummary": true
  },
  {
    "type": "SELECT",
    "name": "eventName",
    "displayName": "Event Type*",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "inherit",
        "displayValue": "Inherit from GA4 (default)"
      },
      {
        "value": "custom",
        "displayValue": "Custom"
      },
      {
        "value": "pageLoad",
        "displayValue": "Page Load"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "inherit"
  },
  {
    "type": "GROUP",
    "name": "group1",
    "displayName": "Custom Event Data",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "TEXT",
        "name": "ea",
        "displayName": "Event Action*",
        "simpleValueType": true,
        "canBeEmptyString": false,
        "enablingConditions": [
          {
            "paramName": "eventName",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ],
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "el",
        "displayName": "Event Label",
        "simpleValueType": true,
        "canBeEmptyString": true,
        "enablingConditions": [
          {
            "paramName": "eventName",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "ec",
        "displayName": "Event Category",
        "simpleValueType": true,
        "canBeEmptyString": true,
        "enablingConditions": [
          {
            "paramName": "eventName",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "ev",
        "displayName": "Event Value",
        "simpleValueType": true,
        "canBeEmptyString": true,
        "enablingConditions": [
          {
            "paramName": "eventName",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ]
      }
    ],
    "enablingConditions": [
      {
        "paramName": "eventName",
        "paramValue": "custom",
        "type": "EQUALS"
      }
    ]
  },
  {
    "displayName": "User Data",
    "name": "userDataGroup",
    "groupStyle": "ZIPPY_OPEN_ON_PARAM",
    "type": "GROUP",
    "subParams": [
      {
        "name": "userData",
        "simpleTableColumns": [
          {
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ],
            "defaultValue": "em",
            "displayName": "Property Name",
            "name": "name",
            "isUnique": true,
            "type": "SELECT",
            "selectItems": [
              {
                "value": "uid",
                "displayValue": "uid"
              },
              {
                "value": "vid",
                "displayValue": "vid"
              },
              {
                "value": "em",
                "displayValue": "Email (sha-256)"
              }
            ]
          },
          {
            "defaultValue": "",
            "displayName": "Property Value",
            "name": "value",
            "type": "TEXT"
          }
        ],
        "type": "SIMPLE_TABLE",
        "newRowButtonText": "Add property"
      }
    ],
    "help": "Please refer to this Refer to this documentation for more information on the user data parameters you can include in the request. The tag will automatically hash relevant data using SHA256 before transmitting the event to Facebook."
  },
  {
    "type": "GROUP",
    "name": "group3",
    "displayName": "Advanced Settings",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "sendWhenAdblockedOnly",
        "checkboxText": "Only trigger the S2S pixel when ad blocking is detected.",
        "simpleValueType": true,
        "alwaysInSummary": true,
        "defaultValue": true,
        "help": "Check this option if you want to complete existing data (events are tracked in the browser). Do not check it if you use a dedicated MS Tag Id to track server-side."
      },
      {
        "type": "CHECKBOX",
        "name": "sendPixelFromBrowser",
        "checkboxText": "Send the pixel request to the browser whenever consent is granted or detected — but no adblocker is detected.",
        "simpleValueType": true,
        "help": "Send a pixel request back to the browser if consent is given. Only activate this option if you don\u0027t load the MS SDK in user\u0027s browser, or to use a different UET Tag Id, to avoid duplicate tracking.",
        "defaultValue": true,
        "alwaysInSummary": true
      },
      {
        "type": "CHECKBOX",
        "name": "createCookie",
        "checkboxText": "Generate \"_uetmsclkid\",  \"_uetvid\" and  \"_uetsid\" cookies whenever consent is granted or detected.",
        "simpleValueType": true,
        "alwaysInSummary": false,
        "defaultValue": true
      },
      {
        "type": "CHECKBOX",
        "name": "forwardUserEmails",
        "checkboxText": "Boost tag efficiency by automatically sending hashed user emails (SHA-256) when consent is granted or detected.",
        "simpleValueType": true,
        "alwaysInSummary": true,
        "help": "Automatically send hashed email found in GA4 user_data or the \"Gtm-Helper-User-Hashed-Email\" header proposed by \u003ca href\u003d\"https://server-side.docs.sirdata.net/sirdata-server-side/english-1/installation/data-processing/gtm-helper-layer\" target\u003d\"_blank\"\u003eSirdata\u003c/a\u003e if you subscribed to it, for imroved tracking.",
        "defaultValue": true
      },
      {
        "type": "CHECKBOX",
        "name": "firstClick",
        "checkboxText": "Track First Click instead of Last Click",
        "simpleValueType": true
      },
      {
        "type": "CHECKBOX",
        "name": "sendWithoutConsent",
        "checkboxText": "Experimental: send data without cookies when consent isn\u0027t given, using a cookieless user ID provided by Sirdata.",
        "simpleValueType": true,
        "help": "To use the cookieless user ID, the client must subscribe to the \"site-only cookieless user ID\" option offered by \u003ca href\u003d\"https://server-side.docs.sirdata.net/sirdata-server-side/english-1/installation/data-processing/gtm-helper-layer\" target\u003d\"_blank\"\u003eSirdata\u003c/a\u003e, which doesn\u0027t allow tracking accross websites.",
        "alwaysInSummary": true
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

const computeEffectiveTldPlusOne = require('computeEffectiveTldPlusOne');
const createRegex = require('createRegex');
const sendHttpGet = require('sendHttpGet');
const getEventData = require('getEventData');
const generateRandom = require('generateRandom');
const logToConsole = require('logToConsole');
const Math = require('Math');
const encodeUriComponent = require('encodeUriComponent');
const JSON = require('JSON');
const getCookieValues = require('getCookieValues');
const setCookie = require('setCookie');
const parseUrl = require('parseUrl');
const getAllEventData = require('getAllEventData');
const getRequestQueryParameter = require('getRequestQueryParameter');
const getRequestHeader = require('getRequestHeader');
const sha256Sync = require('sha256Sync');
const getTimestampMillis = require('getTimestampMillis');
const sendPixelFromBrowser = require('sendPixelFromBrowser');
const testRegex = require('testRegex');
const Object = require('Object');

const getNonEmptyValueOnly = function (obj) {
  if (!obj) { return; }
  let objString = obj.toString();
  if(objString === "undefined" || objString === null || objString === "" ) {
    return;
  } else {
    return obj;
  }
};

const getValueFromHeader = function (headerName) {
    if (!headerName) { return; }
    let valueFromHeader = getRequestHeader(headerName);
  if (!valueFromHeader || valueFromHeader == "undefined") { return; }
    return getNonEmptyValueOnly(valueFromHeader);
};

const isSHA256Hashed = function (data) {
    return data.match('^[A-Fa-f0-9]{64}$') !== null;
};

const getValidSHA256Hash = function (data){
  if(data && !isSHA256Hashed(data)){
    return sha256Sync(data.toString().trim().toLowerCase(), {outputEncoding: 'hex'});
  }
  return data;
};

const isValidEmail = function (email) {
  if (!email || email.indexOf("@") === -1 || email.indexOf(".") === -1) {
    return false;
  }
  const validChars = '0123456789abcdefABCDEF.@_-';
  for (let i = 0; i < email.length; i++) {
    if (validChars.indexOf(email[i]) === -1) {
      return false;
    }
  }
  return true;
};

const getValidEmail = function(email) {
  if (!email || !isValidEmail(email)) {
    return;
  }
  return email;
};

const GA4_MAPPINGS_PAGE_TYPES = {
  'add_payment_info': 'Cart',
  'add_to_cart': 'Cart',
  'begin_checkout': 'Cart',
  'page_view': 'pageLoad',
  'purchase': 'Purchase',
  'select_item': 'Product',
  'search': 'Search results',
  'view_item': 'Product',
  'view_item_list': 'category'
};

const GA4_MAPPINGS_EVENTS = {
  'page_view': 'pageLoad',
};

const getEventName = function(eventName, data) {
  if (data.eventName == "inherit") {
    return (GA4_MAPPINGS_EVENTS[eventName] || "custom");
  }
  return data.eventName;
};

const getPageType = function(eventName) {
  let pageType = GA4_MAPPINGS_PAGE_TYPES[eventName];
  if (!pageType || pageType !== "PageLoad") {
    return pageType;
  }
  return (isProbablyHomepage(url) ? "Home" : "Other");    
};

const eventData = getAllEventData();
const eventName = getNonEmptyValueOnly(eventData.event_name);
const msEventName = getEventName(eventData.event_name, data);
const isAdblocked = getValueFromHeader('gtm-helper-user-has-adblocker') === 'true';
const gcsParam = getRequestQueryParameter('gcs') || eventData['x-ga-gcs'];
const consentGranted = (getValueFromHeader('gtm-helper-consent-personalized-ads') === 'true' || (gcsParam && gcsParam[2]=='1') || (getValueFromHeader('gtm-helper-gdpr-applies') === 'false' && !gcsParam)) ? true : false;
const msCookiesAllowed = consentGranted && (eventName == 'page_view' || data.eventName !== 'inherit');

if (
    !data.tag_id ||
    (!data.sendWithoutConsent && !consentGranted) ||
    (data.eventName === 'pageLoad' && eventName !== 'page_view')
   ) {
  data.gtmOnSuccess();
  return;
}

const generateUUIDv4 = function() {
  const regex = createRegex('[xy]', 'g');
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(regex, function(c) {
    const r = generateRandom(1, 15);
    if (c === 'x') {
      return r.toString(16);
    } else {
      const y = [8, 9, 10, 11][r % 4];
      return y.toString(16);
    }
  });
};

const stringToVidSid = function (str) {
  var ascii = {};
  var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@._-';
  for (var i = 0; i < chars.length; i++) {
    ascii[chars[i]] = i + 1;
  }
  str = '' + str;
  var hash = 1;
  var hex = '';
  for (var j = 0; j < str.length; j++) {
    var c = str[j];
    var n = ascii[c] || j + 17;
    hash = (hash * 31 + n);
    if (hash > 1000000000) {
      hash = hash % 1000000000;
    }

    var h = '' + (hash).toString(16);
    hex += h;
  }
  return (hex + '00000000000000000000000000000000').substring(0, 32);
};

const getStartOfHourUtc = function (ts) {
  var msInHour = 3600000; // 60 * 60 * 1000
  return Math.floor(ts / msInHour) * msInHour;
};

const setUETCookie = function (clickIdCookieName, msclkid, domain, duration) {
    if (!msclkid || msclkid === 'N') { return; }
    let options = {"max-age": duration, httpOnly: false};
    if (domain) {
      options.domain = "." + domain;
    }
    setCookie(clickIdCookieName, msclkid, options);
};

const isValidHost = function (host) {
  let blockRegex = createRegex("^(localhost|\\d{1,3}(\\.\\d{1,3}){3}|\\[.*\\]|.*:)$", "i");
  if (testRegex(blockRegex,host)) {
    return false;
  }
  let domainRegex = createRegex("^[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+$");
  return testRegex(domainRegex,host);
};

const getValidHost = function (host) {
  return (isValidHost(host) ? host : null);
};

const userIp = getValueFromHeader('gtm-helper-user-ip') || eventData.ip_override || getValueFromHeader('x-appengine-user-ip');
const url = eventData.page_location || getRequestHeader('referer') || getValueFromHeader('gtm-helper-site-origin');
const urlParsed = parseUrl(url);
const referrer = eventData.page_referrer;
const referrerParsed = parseUrl(referrer);
const originDomain = getValueFromHeader('gtm-helper-site-domain') || computeEffectiveTldPlusOne(url);
const originHost = getValueFromHeader('gtm-helper-site-host');
const sstDomain = getValueFromHeader('gtm-helper-server-domain');
const cookieDomain = sstDomain || originDomain;
const sstHost = getValueFromHeader('gtm-helper-server-host') || getValidHost(getValueFromHeader('host'));
const screenResolution = getEventData('screen_resolution');

const defaultHomeFiles = [
  'index.html', 'index.htm', 'index.php',
  'default.html', 'default.htm',
  'home.html', 'home.php',
  'main.html', 'start.html',
  'index.asp', 'index.aspx', 'landing.html'
];

const isProbablyHomepage = function (url) {
    const regex = createRegex("\\/+$", "i");
    const path = urlParsed.pathname.replace(regex, '');
    const parts = path.split('/').filter(function(part) {
      return part !== '';
    });
    const langPattern = createRegex("^[a-z]{2}(-[A-Z]{2})?$");
    if (parts.length === 0) return true;
    if (parts.length === 1 && testRegex(langPattern, parts[0])) { return true; }
    if (parts.length === 1 && defaultHomeFiles.includes(parts[0])) { return true; }
    if (parts.length === 2 && testRegex(langPattern, parts[0]) && defaultHomeFiles.includes(parts[1])) { return true; }
    return false;
};

let msclkid = 'N';
let msclkidSuffix = "-0";
let screenWidth, screenHeight = "";
let items_data;
let paramsToSend = {};
let sid;
let vid;
let sidSeed = (data.sendWithoutConsent ? getStartOfHourUtc(getTimestampMillis()) : getNonEmptyValueOnly(getEventData('ga_session_id')));
let vidSeed = (data.sendWithoutConsent ? getNonEmptyValueOnly(getValueFromHeader('gtm-helper-cookieless-id-domain-specific')) : getNonEmptyValueOnly(getEventData('client_id')));

const processSetCookiesHeaders = function (headers) {
  if (!msCookiesAllowed || !isValidHost(sstHost) || !getNonEmptyValueOnly(headers)) {
    return;
  }
  let headersEntries = Object.entries(headers);
  headersEntries.forEach(function(entry) {
    if (entry[0].toLowerCase() === 'set-cookie' && entry[1].length > 0) {
      entry[1].forEach(function(value) {
        let parts = value.split('=');
        let cookieName = parts[0].trim();
        if (cookieName === 'MUID' || cookieName === 'MSPTC') {
          let cookieValue = parts[1].split(';')[0].trim();
          let options = {'max-age': 31536000, httpOnly: true, sameSite: "none", secure: true, domain: sstHost};
          setCookie('_uet_ss_' + cookieName, cookieValue, options);
        }
      });
    }
  });
};

const items_id = function () {
  if (!items_data) {
    return '';
  }
  const ids = [];
  for (let i = 0; i < items_data.length; i++) {
    ids.push(items_data[i].item_id);
  }
  return ids.join(',');
};

const items = function () {
  if (!items_data) {
    return "";
  }
  const formattedItems = [];
  for (let i = 0; i < items_data.length; i++) {
    let item = items_data[i];
    formattedItems.push(
      "id=" + item.item_id + ";quantity=" + item.quantity + ";price=" + item.price
    );
  }
  return formattedItems.join(",");
};

let em;

if (url) {
  if (urlParsed && urlParsed.searchParams.msclkid) {
    msclkid = urlParsed.searchParams.msclkid;
    msclkidSuffix = "-1";
  } else {
    if (referrerParsed && referrerParsed.searchParams.msclkid) {
      msclkid = referrerParsed.searchParams.msclkid;
    }
  }
}

if (consentGranted) {  
  sidSeed = sidSeed || getNonEmptyValueOnly(getEventData('ga_session_id'));
  const sidFromCookie = getCookieValues('_uetsid')[0];
  if (sidFromCookie) {
    sid = sidFromCookie;
  } else if (data.createCookie) {
    sid = stringToVidSid(sidSeed);
    setUETCookie('_uetsid', sid, cookieDomain, 3600);
  }
  
  vidSeed = vidSeed || getNonEmptyValueOnly(getEventData('client_id'));
  const vidFromCookie = getCookieValues('_uetvid')[0];
  if (vidFromCookie) {
    vid = vidFromCookie;
  } else if (data.createCookie) {
    vid = stringToVidSid(vidSeed);
    setUETCookie('_uetvid', vid, cookieDomain, 31536000);
  }
  
  const msclkidFromCookie = getCookieValues('_uetmsclkid')[0];
  
  if (data.createCookie && msclkid !== 'N' && (!msclkidFromCookie || !data.firstClick)) {
    setUETCookie('_uetmsclkid', "_uet" + msclkid, cookieDomain, 31536000);
  }

  if (msclkidFromCookie && (msclkid == 'N' || data.firstClick)) {
    msclkid = msclkidFromCookie.replace('_uet', '');
    msclkidSuffix = "-0";
  }

  if (data.forwardUserEmails) {
    let emt = getValidSHA256Hash(getNonEmptyValueOnly(data.em));
    em = emt ? emt : (eventData.user_data && eventData.user_data.sha256_email_address ? getValidSHA256Hash(eventData.user_data.sha256_email_address) : null);
    if (!em && eventData.user_data) {
      em = getValidSHA256Hash(getValidEmail(eventData.user_data.email_address) || getValidEmail(eventData.user_data.email));
    }
    if (!em) {
      em = getValidSHA256Hash(getValueFromHeader('gtm-helper-user-hashed-email'));
    }
  }
}

if (!sid) {
  sid = stringToVidSid(sidSeed);
}

if (!vid) {
  vid = stringToVidSid(vidSeed);
}

if (msclkid !== "N") {
  msclkid = msclkid + msclkidSuffix;
}

if (getNonEmptyValueOnly(screenResolution)){
  screenWidth = screenResolution.split('x')[0]||"";
  screenHeight = screenResolution.split('x')[1]||"";
}

if(getNonEmptyValueOnly(getEventData('items'))){
  items_data = getEventData('items');
}

paramsToSend.asc = "G";
paramsToSend.cdb = "AQET";
paramsToSend.bo = "1";
paramsToSend.evt = msEventName;
paramsToSend.rn = generateRandom(100000, 999999);
paramsToSend.ti = data.tag_id;
paramsToSend.mid = generateUUIDv4();
paramsToSend.ver = '2.3';
paramsToSend.p = url;
paramsToSend.r = referrer;
paramsToSend.tl = getEventData('page_title');
paramsToSend.lg = getEventData('language');
paramsToSend.sw = screenWidth;
paramsToSend.sh = screenHeight;
paramsToSend.sc = getEventData('screen_color_depth');
paramsToSend.spa = "N";
paramsToSend.msclkid = msclkid;
paramsToSend.uid = getNonEmptyValueOnly(data.vid) || getEventData('user_id');
paramsToSend.sid = sid;
paramsToSend.vid = getNonEmptyValueOnly(data.vid) || vid;
if (msEventName == "custom") {
  paramsToSend.pagetype = getPageType();
  let contentCategory;
  if (eventData.items && eventData.items[0] && eventData.items[0].item_category) {
    contentCategory = eventData.items[0].item_category;
  }
  paramsToSend.ec = getNonEmptyValueOnly(data.ec) || getEventData('category') || getEventData('pageCategory') || contentCategory;
  paramsToSend.ecomm_category = paramsToSend.ec;
  paramsToSend.gv = getEventData('value');
  paramsToSend.ea = getNonEmptyValueOnly(data.ea) || eventName;
  paramsToSend.el = getNonEmptyValueOnly(data.el) || getEventData('label') || eventName;
  paramsToSend.ev = getNonEmptyValueOnly(data.ev) || paramsToSend.gv;
  paramsToSend.prodid = items_id();
  paramsToSend.search_term = getNonEmptyValueOnly(data.searchTerm) || getEventData('search_term');
  paramsToSend.items =  items();
  paramsToSend.transaction_id = getEventData('transaction_id');
  paramsToSend.gc = getEventData('currency');
}
if (em) {
  paramsToSend.pid = "em="+em;
}

logToConsole("Bing Params: " + JSON.stringify(paramsToSend));

var endpoint = 'https://bat.bing.com/action/0?';
if (getNonEmptyValueOnly(paramsToSend)) {
  var paramList = [];
  for (var key in paramsToSend) {
    var value = paramsToSend[key];
    if (value !== undefined && value !== null && value !== "") {
      paramList.push(key + "=" + encodeUriComponent(value));
    }
  }

  endpoint += paramList.join("&");
}

if (consentGranted && data.sendPixelFromBrowser && !isAdblocked) {
  sendPixelFromBrowser(endpoint);
}

if (isAdblocked || !data.sendWhenAdblockedOnly) {
  let headersToSend = {
    'x-forwarded-for': userIp,
    'cache-control': 'no-cache',
    'accept': 'image/*',
  };

  const xForwardedProto = getValueFromHeader('x-forwarded-proto');
  if (xForwardedProto) {
    headersToSend['x-forwarded-proto'] = xForwardedProto;
  }

  const forwarded = getValueFromHeader('forwarded');
  if (forwarded) {
    headersToSend.forwarded = forwarded;
  }

  if (isValidHost(originHost)) {
    headersToSend['x-forwarded-host'] = originHost;
  }

  let ua = getValueFromHeader('gtm-helper-device-user-agent') || getValueFromHeader('user-agent');
  if (ua) {
    headersToSend['user-agent'] = ua;
  }

  let acceptEncoding = getValueFromHeader('accept-encoding');
  if (acceptEncoding) {
    headersToSend['accept-encoding'] = acceptEncoding;
  }

  let acceptLanguage = getValueFromHeader('accept-language');
  if (acceptLanguage) {
    headersToSend['accept-language'] = acceptLanguage;
  }

  let origin = getValueFromHeader('origin');
  if (origin) {
    headersToSend.origin = origin;
  }

  let referer = getValueFromHeader('referer');
  if (referer) {
    headersToSend.referer = referer;
  }

  if (consentGranted) {
    let cookieValues = [];
    const cookieMUID = getCookieValues('_uet_ss_MUID')[0];
    if (cookieMUID) {
      cookieValues.push('MUID='+ cookieMUID);
    }
    const cookieMSPTC = getCookieValues('_uet_ss_MSPTC')[0];
    if (cookieMSPTC) {
      cookieValues.push('MSPTC='+ cookieMSPTC);
    }
    if (cookieValues.length > 0) {
      headersToSend.cookie = cookieValues.join(';') +';';
    }
  }

  return sendHttpGet(endpoint, {
    headers: headersToSend,
    timeout: 1000,
  }).then((result) => {
    if (result.statusCode >= 200 && result.statusCode < 300) {
      if (consentGranted) {
        processSetCookiesHeaders(result.headers);
      }    
      data.gtmOnSuccess();
    } else {
      logToConsole('Error: ' + result.statusCode);
      data.gtmOnFailure();
    }
  });
} else {
  data.gtmOnSuccess();
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://bat.bing.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_event_data",
        "versionId": "1"
      },
      "param": [
        {
          "key": "eventDataAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "_uetmsclkid"
              },
              {
                "type": 1,
                "string": "_uetsid"
              },
              {
                "type": 1,
                "string": "_uetvid"
              },
              {
                "type": 1,
                "string": "_uet_ss_MUID"
              },
              {
                "type": 1,
                "string": "_uet_ss_MSPTC"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uetmsclkid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uetvid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uetsid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uet_ss_MUID"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uet_ss_MSPTC"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "headerWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-user-has-adblocker"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-consent-personalized-ads"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-user-hashed-email"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-user-ip"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-site-domain"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-gdpr-applies"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-cookieless-id-domain-specific"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "referer"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-server-domain"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "accept-encoding"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "accept-language"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-device-user-agent"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "user-agent"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "origin"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "forwarded"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "host"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-site-host"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-server-host"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "x-forwarded-proto"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "queryParametersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "remoteAddressAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "headersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "queryParameterWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "queryParameter"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gcs"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel_from_browser",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://bat.bing.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 4/27/2024, 12:10:56 PM


