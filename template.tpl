___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "sirdata_templates_sgtm_ms_bing_capi",
  "version": 1.0,
  "securityGroups": [],
  "displayName": "GDPR Ready Bing/Microsoft Ads CAPI by Sirdata",
  "categories": [
    "ADVERTISING",
    "ANALYTICS",
    "ATTRIBUTION",
    "CONVERSIONS",
    "MARKETING",
    "REMARKETING"
  ],
  "brand": {
    "id": "sirdata",
    "displayName": "Sirdata",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF8AAABfCAYAAACOTBv1AAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV/TSqVUHMwgUiFDdbIgKuKoVShChVArtOpgPvoFTRqSFBdHwbXg4Mdi1cHFWVcHV0EQ/ABxdnBSdJES/5cUWsR4cNyPd/ced+8ArllVNCs0Dmi6bWZSSSGXXxXCrwhhGDwiiEmKZcyJYhq+4+seAbbeJViW/7k/R59asBQgIBDPKoZpE28QT2/aBuN9Yl4pSyrxOfGYSRckfmS67PEb45LLHMvkzWxmnpgnFkpdLHexUjY14iniuKrplM/lPFYZbzHWqnWlfU/2wmhBX1lmOs0YUljEEkQIkFFHBVXYSNCqk2IhQ/tJH/+Q6xfJJZOrAoUcC6hBg+T6wf7gd7dWcXLCS4omgZ4Xx/kYAcK7QKvhON/HjtM6AYLPwJXe8deawMwn6Y2OFj8C+reBi+uOJu8BlzvA4JMhmZIrBWlyxSLwfkbflAcGboHImtdbex+nD0CWukrfAAeHwGiJstd93t3b3du/Z9r9/QBX3HKc8E0KhwAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+gEHRQSJUnvtfUAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAU7ElEQVR42u2dW4xk2VWmv7X2PhEZWZlZt67q+w1saAPj7nK17cEXBI1tZozB3CTACIF4GFlCQgIhjeYRzQM8zIB4mMvDIMTgkSxsY8tCmPbYnunBhsbQ7TY2uOluX9rtvtQ1OytvEefsvdY87BOREdFZ2el2RnVWVR5pZUZlRJyoWHuff/3rX2vvI+7uHByvyqEHLjhw/nV5xL0/pWMuGCAY4hkxxVVxlTLangEQCQczfy8Pc8EtETxBNmqJrKmAZTBHspFR7Dp3/ExmvgFRwd255JG//toaf7diLNDjx+5o+L6jHeasgVBd96gne812soN6w2qO/OmXVvnQxUBfFbMNFmOX990M77ljnhNz2kKQ4yrIgfP3AnbAyTy94vz6I5us+Ba8xBzZjIkHFht+8Y45XnOyoitGtMgQhdwdketjKHQWJzTLrDSZ5alhzdWAnnT4zKUu/+HJzEef7LPad2qtMbPryvEzopqOSEBzoOPV1GUhZNtgLjdsrDv/5ZnI73yp5ssXHcuZ6y3f23uq6YKJ4GZknJC3HOoecQEHMkZMxiMXA99YqfnpuyPvuU053jUMcBQ1UHFQOZj5u5/7Tomg0n6Ejj5KnOL9sY8+bx3+x1POHzyyyhcu9jGMSI2p0VzDMDRjridAGLPL/CcsEyzxqbUuv/NY5mNPOSs5EnOaRRZ4DSdZOAHBpeWdZls2nPVTZq5k6TGnwoU+/LevDvizp2s2HVzGYcsPnP9ySZYCLgIGZjYyN3CTlxheYkSqBadDk52P/Evmr7+1WZ6/Bh0/e9hxcJctM2kHYGdL7qzaHH/8lPPMSsbMWi1IDpz/bTl/3LHjA7GDKR2SrvPsxiEeP98n53wAO7sLsVKIoghknWI7viszEzR1acT4izMd+jgZaCwdOP9KHt96sWG9FlRAw7UlxMXZoo6P8PqVHpeILK8nTs6Hgl0aDpy/A8wjOLgiOaDjF5e3+RVjOdgoMI/huUhRO3GyCOtJS2HmGqsBxFnN+GEmK2POd/cJ6XgoJLuPjUr7dx++XwDR4ckOnL/rQXAwt7EJPem97xSSDpz/cuzHJ8WGy10F06JEmeiTRRZxrqnZH2freEfGVc0xbJHL+NFbyJcx+FdKDDiAnW8z+O6UGF3umUl4usam+xWDnVeYkI4P2LVcXokz87k52mR2l5PKRL7nbiO3u7a5oGw3SBlk+EqZpLUHAbcolrt+7TYRYUc9RxQc1K+WfP0KU03flfOnw69uAc5OvvdSNxhQmFPneocdxYo+r46bDnGjPfJkFjuR+vr2MCR5As7MMkrAxMiN8OilzOPnMgHj9Sc7vOYwdLTQpeCFcXkI+zJk77nzRQxxxcm4yYSPJ/zrW/73qScvr9v76EQJ5/+cSfzhEy9yhmMQAksXEj9+uOGB2zt8/0Ii6TwRUGuT5OstyRpidpELZEq/GXf+2HvEtwZtWnaQUqpcz/DJZ53nwwnmkqC5oZ8i/2tQ8cnzDf/2eJefvHuV2+dBZGFf0tXZYz7jNVh5aTa1Laf0rff5GM/3MgRuidqEc4OEaAcjsxGUjitRai4ofOBi5hOXOvzcCeXdtzg3LQgRw0QRN1xAXabg78oeMyimjDnPfbJWu81V4UUAIhgjw2Rknkt1C2nFNhwRoxuUew4pTTY6Ah0RXBynQqxioIEzOfBfnzd+49E1PvDVdV6owa0dVhfsVU4iZo6EYv6yRjsII2Pr8TTbyaqIRJZUectNykLuMxBFpjS6aGUiuMCTGvn95yO//feX+Nizfc4OjOQgqS41gms1w5VdTi/nMoF5Sg+qHAwlqPG644HbesZTA6HjNgEh6qWTwrRQUlT5B5/jC99M3H92jffdeoj7jnU4IfKqpQd7358v2lZshVzb7lr9posp48FRxqBCW6GtdfLRXuSB+XW+1o9YsImv42rlChLBEcQTEQMP/G2zxOeevsAD5zv80okF7j+uzEUIKWBSMuUmZCrC1TfzRyHSwfMryHDzZOidvgak/dkhceq2Qxw+33Axdoi+bchu4ccxSlwwa+iHef7qUuJzG5u8azny6ye73Hp0QKQiS6bKFTP2/YyvOAPSy5ukkkuNbPx5c9zaspZPnz5xz7HA6cWSTF12MsgWBJmCBwiiWKfDijZ8YL3Pr31zmc+cCTRNBHNMZh+NdSY430rvktltt8gEwxn/uydK26FvR2UrDmnDW04InfZysfbC8Xa2u9iocddwkhjZDbcG8QFWdZHgPO6Z33zhLB88d5HaFby0q5CdYd/0/qeaLZcXdzTvku3YVE/n2HOeGRVkpjNfRRFRXndD5MZQAMYcMl5a0cVwye1jMHGMjOB4UFJQmjwg46QoLIfIfzq/xifOrrHplMV7Asm/HYFwn8COG5DsO7OXZUuB2xeUf73UlDkveTJotLDjYxdWVshSzFq1Olj5sWpz/Mfzqzx09kWyCia5VNLsasN8Cl5/J8YOWC5taO9hvOlkByQjYhTSP/m+LG3QHSLb0NqAHA26dWYuDMgE/vOFNR5Z2SCYISRMrwLni+SWXoDngGUZmbvuYGxvKbdO05firmgRzkLk9HHlnl4DolgVMMltxiskjOy5NB1KxjThmhAaBCtBKoCESNZAwjgrwp+eOc/ZuoVR8ats5vsk5pN3Mtnedvmdj1SRdx7rsBkzltMEzFgLLzYOP4AhqDgBJwx/jz1+ODt/9eJFmpRHq+avKtiZmMbZIOdtzC5LQ3eb/Ytk3nxMOJ4GBJ0iT0NnbzMgOnK2bQ2ADB/DRy+t80wD4mH/O99aeSCnMqPVtuyy09intZ6x/2Au/wzsvEw0o9y65Jw6HoogV3rS28y5xAETyCIkAUcIPl66EYIJwaXtDzI60rCcnU8vXyC5U+Ntq7vv75mfs5ETu1oMUWw80NpWwM2+1X64gyYfDOY18lOH58kiI2pZMltvOX9LWtxRDHUv3c84wcusL9KII21p0qLwj4N1zuVM1RaH9mqRxgwCbhtvzUipDMDQaLY3T07OeWQFhjKkXAbCxyDscgCn0Ejg+486r+8OtsX7IQQpGfVMILc438LMBPwYSqDjxtNN4otra3gykqQ9k6JnoOdrq6oYnm2SuYzNdMZMbJrl+EttF5/cTc7JXua3bl/gtiiYtxluAFMluJMlIZ7RtloWcFS8zHbZehwo6wGqbIhHHl2/RCNeHG/7FXa8UMKggmZrg2wx9zGzcSuwMrTp54o64DvSPWllQqHi9An4vTsDPzK/jsaGQ2Z4aMihoSLjEVxLz0loV08i5fyiRhAhIqhlLChZnGebPnVOBIlo2BvnX4GONd9WtPedBH2mar27hryt1566MfD7h2/ki+sDPndhjU83Nf+0aVD1CPRJklmIFSEZihNFC8sZ0U0I0sYGnJXsnLOau6w7WWPer84Xn8TpiTZAmZSIJye1bvtwN12bwwGoTFjoJN7arTi9tMivmPDkcsOD62s8uNHleVslJ6fyiLY7YAUY0U1t4Sh4iQUbGS5YzR0GEnxP1Oa9X5ki3q47V7zOU8xAtpXw3Scl4eH+O2LlXJWEkgXv8kIQEZA4+nILlbKAcMtNHX7QevzqoM+XV4SHVhu+vNnnPEaMFV0zxHKBTBUkK6JlIFwTZwYJOQTicU+aIfYc87d8WAKl2Za9RLMZKpruEwHX3LcWT+fc6vnwyr+xjH52BV7bUX7ixCK/e+cxfkUPs/CFDTgnmDZ4rBC69BigLQwNqae543soLc9g1xEftYaPiuCXkx7GS4VjU9rMS2+/OZnxRdB7cWUqmcigD5/6uz5//vFlnnt2jlStcuwNiTt+eI7V+RepfYEOqWA/Rvadqe7+cP5YM5Rlu/zFNVWy9fH2A5dR57GZT3S27db/bpmsAbw4L3lZ55K9z2Nfa/jvHz3DZx9X+o1Dlak3Gp57aJ5zT5zjvvctkG5NRCv01DGiChnDWv6/L50vY7g7pJA7kqHx8teYRiEiBbsVVMeDg+waUcUNwcguBN/g2eXIhx7q8xd/s8kLdQ/RmiAZQ4ihIrOCPHeYx/5owBve36E5USMBNDkVgUr3tudz5h1rZHsF77NRquyvsIphLqg0mCubA+Gzjyf++FMXeOpZZcUSiiEyT4wN2RMeBMsLuDSk8wOe+GDg3vf3sLBONyohweHYLaUC3ZvVMjNzvgy9b5cl81OvlkmKOlz9tmtVue0Jbc+jWhqjvvJcw0c+d4nP/JOx2l+k6W3S6c/jg4CFTQRHTdHgaAWNNqgHXnwys/7FmiNv6pLyJl2tWNJYup5ln858aTE/iOIpA9VY99nUslAZY0YTrTpSSoEeiVmHLZrstAGkUZadBi8t6mf6wv99tOF/PnyJFwYR1JGqJialkQQhoSakVoQTVYIIME8OCch8/WHh3jclgi/RiavcWM2VvvM9WiY2mxXow84D91ZOKM5Xt61F5+2X3o5AOlICsDvssoIkOGJ9Nq3i759OfPjhNb5wvoeFBYJfwiViMmy6UlyLxBBoYaRtKSlYWQLq80+tc/rSEWwhcadWHK5K6/te7QI6k72Uvf3pNun8MDbzXQQbc76Ox1sZOt+KBrMbjDfn68sVH/lywye/com1OjLHeqmlSwQZysElgBfnF+6iasNRYWuHAUc2e6w/78y/LnN37xDd9mX7FnbcEmigzkrOsVSq2iONr1CwsXVXQJ7odA0tRS1UM7bDKRiWE4QKQUluBM8s9+Gz36j5+FcyT1+oyXSoxPFc4dkIgcLTW+cHEbI4poURqQYkyKg5qzAtpRO7NJs1Pau5f+EWJAhItWebHe495msgt3qI5D6ew2VEMpkKwD6F4O3f1Ld6DxFMuwQ3hIznxKMXhA8+ts6XztZYAxIq1EtttiiXUrrg2rEuv2UU40exR6S9IspVKqoc0g6b0ud75xa5JR5qr569I5t73yjrgpBZWlCOdhsuXrqcQjkdtWwKuNrH0aYqVg1ZnG+uOg8+tcGnvzqgLz0SGQ0V7kpTZ1RKQ45oK1XbpPPlJQMhW5DU7rqRZMANwXnr0mF6ce8XUswgyXIEZWFBuPkGYXlFS9eYS7td73gSMD4wPpEfDLf2NWv3YGhJxkUL/M0zG/zl1/o8sxppQkVOiRDmQTK5NqoYsZbmqgxrwFvDm0dsyydmPghBGjQIfTGs1/C27zrJ6+fnMPHSPLWfna+UVYi9ucS9p+Z47ElvC9R5bHXJUFMeq2CPzSofb1nwhNgmGz7H4yvKg09u8vBFoe8LBOpRom9lj8iy1Me9lcImswhvI0keiRdS6sMCqFLFgFhDbio0wBteO8cDdy2x4AGZwYq6GQTcgEuiK8J99y3yJw9+i2Z5ka4n8vhmRWO0czgW0xKRGdQ4T61VPPYviU8/l1nJygCnl9cxF9IrEGZFtcjV7aAPl2a5GEkEI7IgG/zSjxzjnoUGz1Ub8GWPJ+qeB1wwz4QcufvOLm94x1ESAyQrlpycHMvDWu5wz82XSsiWHQ+Zoz+wyIeXB/zZ+R59VyQYKpnGIyZx22TZd8h/GaGMjEyREiO8baTqZN5+X4cffWMPoUsTa8Rk/898BGLoAvCaTofvvr/HyovGE3+5htscrhmjJhLAm4LE3sWDtfVfQVJm8Q7hu951A93bOvSTUHlDPwbIQiCAelsKkOGyR6xduW6SkZYSmgBqeGjbUBzEdBRck2c6KKFS+tTkZoE33rbGv/+FIxw7VLXEN85kJelMhbWF6LztpPDcO47DEeGJD6+T+04lXbInEMVbgbZqOqzlVeaPVNzzwDGWTi8yEIMUme463gsJpLAdp5IOjQ5oUJLM8xOnE+//qSVuPVkx62O2NVxxTnd6fEI2sDfeyA139vnG57/Fhcc22LzoNI0WsO8OCMcaXntqgbtOH4ejXTb7meCCa97T9mxp+eao+Uk3iXqEeV7k59/R4Wd/dJGbF0vRZdaHzPIOcYmM9OFD52s+vhLpV0pVZ2ItrC73yYNSMgxR6Sx0iL3AQBrEHB1UiEC2hGZGccFThgyWvKzRNccTeDIsG54UkpCTlFUtqXTPWXa8ActCqpWuRRrr08+Z1x0K/Lv39vjBe4V5nSsytsx+v4aZznwl0IQBP3RDhy+uNDyehaQRr6B3Q6/QwRav3aVkxhZKmhWNnNs9dFpmNMqJx9o+ZYxMyrZRVya0UjWQ1LB2COYHc/zyqT7vfWePu44qHZlrA/KV2UJyts53kCpys8C7bxLOPd9n2XtoUFS03Mysrc9eqW2SPUKej9y3FPjVH2p48w8sMUdot4/Zezr5qjkfMTouuCpvOuo813c+dq4mS8Q9E6hAIduWziNjiZhsk49tU3vZXuZQQXIEbwp8lbyWYxp4z7+Cf/O2Lrcf67U0M+OumCvhCm7FMONdR3Skp3SJvPOksFo3PDhQqAMWnaZpwDoj7l2ugkIZ1W20UHHrlGUb+G2lXdfhHmO4JBrLhFiE+k7qcu8t67z3rZE3371Ir2NEb/f1EW37Nq/scUXvinE0wHtuq/BnEw9uQI4dTCPREr7HX72XeqyHhDdwc6z5sbc4P37qKDf2BlgoLYCjjOtVOq6o85MoJzXzM7dG5mPNg8sbrElvUsvZq8/qNlT9yNu/u+Fn71/ge2+KzEnGfR5NpQsiixFexf2Z5UrejHhcx6yz89D5Pn9+Fs4OAqjSlUytFbmWttvNkFxs+G+ytRTSsaRY2iRkwZtY7jpRZxKR2+aNn399h7d/zzwLHdiPG33Jq3Un6LK8JvOVNeN/X6z5/ErDOkt06waXSBo5fygLTDrfkxMI9PsD8C65LlLFYYd33RR496ketx4JBMulBVAOnD9RMMlkMKWuhX/eNP7fC30eWW8Y+PzoZjduZSHgdjO/SZmQlVAnDsWa0zdVvPuew7z2sFB1CpUdOn0/7vr4qjpfcgl4WRKKMEB5fsP5/MWGJy4N+Pq6s5oiOSm1K8kcTY6mREwNXa25vSu8+XiPU3ctcvth6EpNlk7pVhPdqtEczPzdHbmpGVCx0nfObyZWsrFRG/2mUM+lbmSxo5yYE47MC53oRBGqq+yWZvvS+QNv10Qh6Gg9low4vwJqTtIaQVCP5SYJV9mOsvvS+Xi7yUq7Iaoqo1V0Iq0SSkm22lUUOI5eZbf12J/Ov04OPXDBgfMPnH9wHDj/wPkHx4Hzr+nj/wM1kTK7r0tS4gAAAABJRU5ErkJggg\u003d\u003d"
  },
  "description": "Server-side tag for transmitting conversions and events to Bing/Microsoft Ads, featuring integrated GDPR and consent management controls.",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "LABEL",
    "name": "label1",
    "displayName": "All fields with star (*) are required."
  },
  {
    "type": "TEXT",
    "name": "tag_id",
    "displayName": "UET Tag ID*",
    "simpleValueType": true,
    "canBeEmptyString": false,
    "help": "If you already load MS SDK in user\u0027s browser, unactivate it or use a different UET Tag Id here, to avoid duplicate tracking.",
    "alwaysInSummary": true
  },
  {
    "type": "SELECT",
    "name": "eventName",
    "displayName": "Event Type*",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "inherit",
        "displayValue": "Inherit from GA4 (default)"
      },
      {
        "value": "custom",
        "displayValue": "Custom"
      },
      {
        "value": "pageLoad",
        "displayValue": "Page Load"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "inherit"
  },
  {
    "type": "GROUP",
    "name": "group1",
    "displayName": "Custom Event Data",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "TEXT",
        "name": "ea",
        "displayName": "Event Action*",
        "simpleValueType": true,
        "canBeEmptyString": false,
        "enablingConditions": [
          {
            "paramName": "eventName",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ],
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "el",
        "displayName": "Event Label",
        "simpleValueType": true,
        "canBeEmptyString": true,
        "enablingConditions": [
          {
            "paramName": "eventName",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "ec",
        "displayName": "Event Category",
        "simpleValueType": true,
        "canBeEmptyString": true,
        "enablingConditions": [
          {
            "paramName": "eventName",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "ev",
        "displayName": "Event Value",
        "simpleValueType": true,
        "canBeEmptyString": true,
        "enablingConditions": [
          {
            "paramName": "eventName",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ]
      }
    ],
    "enablingConditions": [
      {
        "paramName": "eventName",
        "paramValue": "custom",
        "type": "EQUALS"
      }
    ]
  },
  {
    "displayName": "User Data",
    "name": "userDataGroup",
    "groupStyle": "ZIPPY_OPEN_ON_PARAM",
    "type": "GROUP",
    "subParams": [
      {
        "name": "userData",
        "simpleTableColumns": [
          {
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ],
            "defaultValue": "em",
            "displayName": "Property Name",
            "name": "name",
            "isUnique": true,
            "type": "SELECT",
            "selectItems": [
              {
                "value": "uid",
                "displayValue": "uid"
              },
              {
                "value": "vid",
                "displayValue": "vid"
              },
              {
                "value": "em",
                "displayValue": "Email (sha-256)"
              }
            ]
          },
          {
            "defaultValue": "",
            "displayName": "Property Value",
            "name": "value",
            "type": "TEXT"
          }
        ],
        "type": "SIMPLE_TABLE",
        "newRowButtonText": "Add property"
      }
    ],
    "help": "Please refer to this Refer to this documentation for more information on the user data parameters you can include in the request. The tag will automatically hash relevant data using SHA256 before transmitting the event to Facebook."
  },
  {
    "type": "GROUP",
    "name": "group3",
    "displayName": "Advanced Settings",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "sendWhenAdblockedOnly",
        "checkboxText": "Only trigger the S2S pixel when ad blocking is detected.",
        "simpleValueType": true,
        "alwaysInSummary": true,
        "defaultValue": true,
        "help": "Check this option if you want to complete existing data (events are tracked in the browser). Do not check it if you use a dedicated MS Tag Id to track server-side."
      },
      {
        "type": "CHECKBOX",
        "name": "sendPixelFromBrowser",
        "checkboxText": "Send the pixel request to the browser whenever consent is granted or detected — but no adblocker is detected.",
        "simpleValueType": true,
        "help": "Send a pixel request back to the browser if consent is given. Only activate this option if you don\u0027t load the MS SDK in user\u0027s browser, or to use a different UET Tag Id, to avoid duplicate tracking.",
        "defaultValue": true,
        "alwaysInSummary": true
      },
      {
        "type": "CHECKBOX",
        "name": "createCookie",
        "checkboxText": "Generate \"_uetmsclkid\",  \"_uetvid\" and  \"_uetsid\" cookies whenever consent is granted or detected.",
        "simpleValueType": true,
        "alwaysInSummary": false,
        "defaultValue": true
      },
      {
        "type": "CHECKBOX",
        "name": "forwardUserEmails",
        "checkboxText": "Boost tag efficiency by automatically sending hashed user emails (SHA-256) when consent is granted or detected.",
        "simpleValueType": true,
        "alwaysInSummary": true,
        "help": "Automatically send hashed email found in GA4 user_data or the \"Gtm-Helper-User-Hashed-Email\" header proposed by \u003ca href\u003d\"https://server-side.docs.sirdata.net/sirdata-server-side/english-1/installation/data-processing/gtm-helper-layer\" target\u003d\"_blank\"\u003eSirdata\u003c/a\u003e if you subscribed to it, for imroved tracking.",
        "defaultValue": true
      },
      {
        "type": "CHECKBOX",
        "name": "firstClick",
        "checkboxText": "Track First Click instead of Last Click",
        "simpleValueType": true
      },
      {
        "type": "CHECKBOX",
        "name": "sendWithoutConsent",
        "checkboxText": "Experimental: send data without cookies when consent isn\u0027t given, using a cookieless user ID provided by Sirdata.",
        "simpleValueType": true,
        "help": "To use the cookieless user ID, the client must subscribe to the \"site-only cookieless user ID\" option offered by \u003ca href\u003d\"https://server-side.docs.sirdata.net/sirdata-server-side/english-1/installation/data-processing/gtm-helper-layer\" target\u003d\"_blank\"\u003eSirdata\u003c/a\u003e, which doesn\u0027t allow tracking accross websites.",
        "alwaysInSummary": true
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

const computeEffectiveTldPlusOne = require('computeEffectiveTldPlusOne');
const createRegex = require('createRegex');
const sendHttpGet = require('sendHttpGet');
const getEventData = require('getEventData');
const generateRandom = require('generateRandom');
const logToConsole = require('logToConsole');
const Math = require('Math');
const encodeUriComponent = require('encodeUriComponent');
const JSON = require('JSON');
const getCookieValues = require('getCookieValues');
const setCookie = require('setCookie');
const parseUrl = require('parseUrl');
const getAllEventData = require('getAllEventData');
const getRequestQueryParameter = require('getRequestQueryParameter');
const getRequestHeader = require('getRequestHeader');
const sha256Sync = require('sha256Sync');
const getTimestampMillis = require('getTimestampMillis');
const sendPixelFromBrowser = require('sendPixelFromBrowser');
const testRegex = require('testRegex');
const Object = require('Object');

const getNonEmptyValueOnly = function (obj) {
  if (!obj) { return; }
  let objString = obj.toString();
  if(objString === "undefined" || objString === null || objString === "" ) {
    return;
  } else {
    return obj;
  }
};

const getValueFromHeader = function (headerName) {
    if (!headerName) { return; }
    let valueFromHeader = getRequestHeader(headerName);
  if (!valueFromHeader || valueFromHeader == "undefined") { return; }
    return getNonEmptyValueOnly(valueFromHeader);
};

const isSHA256Hashed = function (data) {
    return data.match('^[A-Fa-f0-9]{64}$') !== null;
};

const getValidSHA256Hash = function (data){
  if(data && !isSHA256Hashed(data)){
    return sha256Sync(data.toString().trim().toLowerCase(), {outputEncoding: 'hex'});
  }
  return data;
};

const isValidEmail = function (email) {
  if (!email || email.indexOf("@") === -1 || email.indexOf(".") === -1) {
    return false;
  }
  const validChars = '0123456789abcdefABCDEF.@_-';
  for (let i = 0; i < email.length; i++) {
    if (validChars.indexOf(email[i]) === -1) {
      return false;
    }
  }
  return true;
};

const getValidEmail = function(email) {
  if (!email || !isValidEmail(email)) {
    return;
  }
  return email;
};

const GA4_MAPPINGS_PAGE_TYPES = {
  'add_payment_info': 'Cart',
  'add_to_cart': 'Cart',
  'begin_checkout': 'Cart',
  'page_view': 'pageLoad',
  'purchase': 'Purchase',
  'select_item': 'Product',
  'search': 'Search results',
  'view_item': 'Product',
  'view_item_list': 'category'
};

const GA4_MAPPINGS_EVENTS = {
  'page_view': 'pageLoad',
};

const getEventName = function(eventName, data) {
  if (data.eventName == "inherit") {
    return (GA4_MAPPINGS_EVENTS[eventName] || "custom");
  }
  return data.eventName;
};

const getPageType = function(eventName) {
  let pageType = GA4_MAPPINGS_PAGE_TYPES[eventName];
  if (!pageType || pageType !== "PageLoad") {
    return pageType;
  }
  return (isProbablyHomepage(url) ? "Home" : "Other");    
};

const eventData = getAllEventData();
const eventName = getNonEmptyValueOnly(eventData.event_name);
const msEventName = getEventName(eventData.event_name, data);
const isAdblocked = getValueFromHeader('gtm-helper-user-has-adblocker') === 'true';
const gcsParam = getRequestQueryParameter('gcs') || eventData['x-ga-gcs'];
const consentGranted = (getValueFromHeader('gtm-helper-consent-personalized-ads') === 'true' || (gcsParam && gcsParam[2]=='1') || (getValueFromHeader('gtm-helper-gdpr-applies') === 'false' && !gcsParam)) ? true : false;
const msCookiesAllowed = consentGranted && (eventName == 'page_view' || data.eventName !== 'inherit');

if (
    !data.tag_id ||
    (!data.sendWithoutConsent && !consentGranted) ||
    (data.eventName === 'pageLoad' && eventName !== 'page_view')
   ) {
  data.gtmOnSuccess();
  return;
}

const generateUUIDv4 = function() {
  const regex = createRegex('[xy]', 'g');
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(regex, function(c) {
    const r = generateRandom(1, 15);
    if (c === 'x') {
      return r.toString(16);
    } else {
      const y = [8, 9, 10, 11][r % 4];
      return y.toString(16);
    }
  });
};

const stringToVidSid = function (str) {
  var ascii = {};
  var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@._-';
  for (var i = 0; i < chars.length; i++) {
    ascii[chars[i]] = i + 1;
  }
  str = '' + str;
  var hash = 1;
  var hex = '';
  for (var j = 0; j < str.length; j++) {
    var c = str[j];
    var n = ascii[c] || j + 17;
    hash = (hash * 31 + n);
    if (hash > 1000000000) {
      hash = hash % 1000000000;
    }

    var h = '' + (hash).toString(16);
    hex += h;
  }
  return (hex + '00000000000000000000000000000000').substring(0, 32);
};

const getStartOfHourUtc = function (ts) {
  var msInHour = 3600000; // 60 * 60 * 1000
  return Math.floor(ts / msInHour) * msInHour;
};

const setUETCookie = function (clickIdCookieName, msclkid, domain, duration) {
    if (!msclkid || msclkid === 'N') { return; }
    let options = {"max-age": duration, httpOnly: false};
    if (domain) {
      options.domain = "." + domain;
    }
    setCookie(clickIdCookieName, msclkid, options);
};

const isValidHost = function (host) {
  let blockRegex = createRegex("^(localhost|\\d{1,3}(\\.\\d{1,3}){3}|\\[.*\\]|.*:)$", "i");
  if (testRegex(blockRegex,host)) {
    return false;
  }
  let domainRegex = createRegex("^[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+$");
  return testRegex(domainRegex,host);
};

const getValidHost = function (host) {
  return (isValidHost(host) ? host : null);
};

const userIp = getValueFromHeader('gtm-helper-user-ip') || eventData.ip_override || getValueFromHeader('x-appengine-user-ip');
const url = eventData.page_location || getRequestHeader('referer') || getValueFromHeader('gtm-helper-site-origin');
const urlParsed = parseUrl(url);
const referrer = eventData.page_referrer;
const referrerParsed = parseUrl(referrer);
const originDomain = getValueFromHeader('gtm-helper-site-domain') || computeEffectiveTldPlusOne(url);
const originHost = getValueFromHeader('gtm-helper-site-host');
const sstDomain = getValueFromHeader('gtm-helper-server-domain');
const cookieDomain = sstDomain || originDomain;
const sstHost = getValueFromHeader('gtm-helper-server-host') || getValidHost(getValueFromHeader('host'));
const screenResolution = getEventData('screen_resolution');

const defaultHomeFiles = [
  'index.html', 'index.htm', 'index.php',
  'default.html', 'default.htm',
  'home.html', 'home.php',
  'main.html', 'start.html',
  'index.asp', 'index.aspx', 'landing.html'
];

const isProbablyHomepage = function (url) {
    const regex = createRegex("\\/+$", "i");
    const path = urlParsed.pathname.replace(regex, '');
    const parts = path.split('/').filter(function(part) {
      return part !== '';
    });
    const langPattern = createRegex("^[a-z]{2}(-[A-Z]{2})?$");
    if (parts.length === 0) return true;
    if (parts.length === 1 && testRegex(langPattern, parts[0])) { return true; }
    if (parts.length === 1 && defaultHomeFiles.includes(parts[0])) { return true; }
    if (parts.length === 2 && testRegex(langPattern, parts[0]) && defaultHomeFiles.includes(parts[1])) { return true; }
    return false;
};

let msclkid = 'N';
let msclkidSuffix = "-0";
let screenWidth, screenHeight = "";
let items_data;
let paramsToSend = {};
let sid;
let vid;
let sidSeed = (data.sendWithoutConsent ? getStartOfHourUtc(getTimestampMillis()) : getNonEmptyValueOnly(getEventData('ga_session_id')));
let vidSeed = (data.sendWithoutConsent ? getNonEmptyValueOnly(getValueFromHeader('gtm-helper-cookieless-id-domain-specific')) : getNonEmptyValueOnly(getEventData('client_id')));

const processSetCookiesHeaders = function (headers) {
  if (!msCookiesAllowed || !isValidHost(sstHost) || !getNonEmptyValueOnly(headers)) {
    return;
  }
  let headersEntries = Object.entries(headers);
  headersEntries.forEach(function(entry) {
    if (entry[0].toLowerCase() === 'set-cookie' && entry[1].length > 0) {
      entry[1].forEach(function(value) {
        let parts = value.split('=');
        let cookieName = parts[0].trim();
        if (cookieName === 'MUID' || cookieName === 'MSPTC') {
          let cookieValue = parts[1].split(';')[0].trim();
          let options = {'max-age': 31536000, httpOnly: true, sameSite: "none", secure: true, domain: sstHost};
          setCookie('_uet_ss_' + cookieName, cookieValue, options);
        }
      });
    }
  });
};

const items_id = function () {
  if (!items_data) {
    return '';
  }
  const ids = [];
  for (let i = 0; i < items_data.length; i++) {
    ids.push(items_data[i].item_id);
  }
  return ids.join(',');
};

const items = function () {
  if (!items_data) {
    return "";
  }
  const formattedItems = [];
  for (let i = 0; i < items_data.length; i++) {
    let item = items_data[i];
    formattedItems.push(
      "id=" + item.item_id + ";quantity=" + item.quantity + ";price=" + item.price
    );
  }
  return formattedItems.join(",");
};

let em;

if (url) {
  if (urlParsed && urlParsed.searchParams.msclkid) {
    msclkid = urlParsed.searchParams.msclkid;
    msclkidSuffix = "-1";
  } else {
    if (referrerParsed && referrerParsed.searchParams.msclkid) {
      msclkid = referrerParsed.searchParams.msclkid;
    }
  }
}

if (consentGranted) {  
  sidSeed = sidSeed || getNonEmptyValueOnly(getEventData('ga_session_id'));
  const sidFromCookie = getCookieValues('_uetsid')[0];
  if (sidFromCookie) {
    sid = sidFromCookie;
  } else if (data.createCookie) {
    sid = stringToVidSid(sidSeed);
    setUETCookie('_uetsid', sid, cookieDomain, 3600);
  }
  
  vidSeed = vidSeed || getNonEmptyValueOnly(getEventData('client_id'));
  const vidFromCookie = getCookieValues('_uetvid')[0];
  if (vidFromCookie) {
    vid = vidFromCookie;
  } else if (data.createCookie) {
    vid = stringToVidSid(vidSeed);
    setUETCookie('_uetvid', vid, cookieDomain, 31536000);
  }
  
  const msclkidFromCookie = getCookieValues('_uetmsclkid')[0];
  
  if (data.createCookie && msclkid !== 'N' && (!msclkidFromCookie || !data.firstClick)) {
    setUETCookie('_uetmsclkid', "_uet" + msclkid, cookieDomain, 31536000);
  }

  if (msclkidFromCookie && (msclkid == 'N' || data.firstClick)) {
    msclkid = msclkidFromCookie.replace('_uet', '');
    msclkidSuffix = "-0";
  }

  if (data.forwardUserEmails) {
    let emt = getValidSHA256Hash(getNonEmptyValueOnly(data.em));
    em = emt ? emt : (eventData.user_data && eventData.user_data.sha256_email_address ? getValidSHA256Hash(eventData.user_data.sha256_email_address) : null);
    if (!em && eventData.user_data) {
      em = getValidSHA256Hash(getValidEmail(eventData.user_data.email_address) || getValidEmail(eventData.user_data.email));
    }
    if (!em) {
      em = getValidSHA256Hash(getValueFromHeader('gtm-helper-user-hashed-email'));
    }
  }
}

if (!sid) {
  sid = stringToVidSid(sidSeed);
}

if (!vid) {
  vid = stringToVidSid(vidSeed);
}

if (msclkid !== "N") {
  msclkid = msclkid + msclkidSuffix;
}

if (getNonEmptyValueOnly(screenResolution)){
  screenWidth = screenResolution.split('x')[0]||"";
  screenHeight = screenResolution.split('x')[1]||"";
}

if(getNonEmptyValueOnly(getEventData('items'))){
  items_data = getEventData('items');
}

paramsToSend.asc = "G";
paramsToSend.cdb = "AQET";
paramsToSend.bo = "1";
paramsToSend.evt = msEventName;
paramsToSend.rn = generateRandom(100000, 999999);
paramsToSend.ti = data.tag_id;
paramsToSend.mid = generateUUIDv4();
paramsToSend.ver = '2.3';
paramsToSend.p = url;
paramsToSend.r = referrer;
paramsToSend.tl = getEventData('page_title');
paramsToSend.lg = getEventData('language');
paramsToSend.sw = screenWidth;
paramsToSend.sh = screenHeight;
paramsToSend.sc = getEventData('screen_color_depth');
paramsToSend.spa = "N";
paramsToSend.msclkid = msclkid;
paramsToSend.uid = getNonEmptyValueOnly(data.vid) || getEventData('user_id');
paramsToSend.sid = sid;
paramsToSend.vid = getNonEmptyValueOnly(data.vid) || vid;
if (msEventName == "custom") {
  paramsToSend.pagetype = getPageType();
  let contentCategory;
  if (eventData.items && eventData.items[0] && eventData.items[0].item_category) {
    contentCategory = eventData.items[0].item_category;
  }
  paramsToSend.ec = getNonEmptyValueOnly(data.ec) || getEventData('category') || getEventData('pageCategory') || contentCategory;
  paramsToSend.ecomm_category = paramsToSend.ec;
  paramsToSend.ea = getNonEmptyValueOnly(data.ea) || msEventName;
  paramsToSend.el = getNonEmptyValueOnly(data.el) || getEventData('label') || msEventName;
  paramsToSend.ev = getNonEmptyValueOnly(data.ev) || paramsToSend.gv;
  paramsToSend.prodid = items_id();
  paramsToSend.search_term = getNonEmptyValueOnly(data.searchTerm) || getEventData('search_term');
  paramsToSend.items =  items();
  paramsToSend.transaction_id = getEventData('transaction_id');
  paramsToSend.gc = getEventData('currency');
  paramsToSend.gv = getEventData('value');
}
if (em) {
  paramsToSend.pid = "em="+em;
}

logToConsole("Bing Params: " + JSON.stringify(paramsToSend));

var endpoint = 'https://bat.bing.com/action/0?';
if (getNonEmptyValueOnly(paramsToSend)) {
  var paramList = [];
  for (var key in paramsToSend) {
    var value = paramsToSend[key];
    if (value !== undefined && value !== null && value !== "") {
      paramList.push(key + "=" + encodeUriComponent(value));
    }
  }

  endpoint += paramList.join("&");
}

if (consentGranted && data.sendPixelFromBrowser && !isAdblocked) {
  sendPixelFromBrowser(endpoint);
}

if (isAdblocked || !data.sendWhenAdblockedOnly) {
  let headersToSend = {
    'x-forwarded-for': userIp,
    'cache-control': 'no-cache',
  };

  const xForwardedProto = getValueFromHeader('x-forwarded-proto');
  if (xForwardedProto) {
    headersToSend['x-forwarded-proto'] = xForwardedProto;
  }

  const forwarded = getValueFromHeader('forwarded');
  if (forwarded) {
    headersToSend.forwarded = forwarded;
  }

  if (isValidHost(originHost)) {
    headersToSend['x-forwarded-host'] = originHost;
  }

  let ua = getValueFromHeader('gtm-helper-device-user-agent') || getValueFromHeader('user-agent');
  if (ua) {
    headersToSend['user-agent'] = ua;
  }

  let accept = getValueFromHeader('accept');
  if (accept) {
    headersToSend.accept = accept;
  }

  let acceptEncoding = getValueFromHeader('accept-encoding');
  if (acceptEncoding) {
    headersToSend['accept-encoding'] = acceptEncoding;
  }

  let acceptLanguage = getValueFromHeader('accept-language');
  if (acceptLanguage) {
    headersToSend['accept-language'] = acceptLanguage;
  }

  let origin = getValueFromHeader('origin');
  if (origin) {
    headersToSend.origin = origin;
  }

  let referer = getValueFromHeader('referer');
  if (referer) {
    headersToSend.referer = referer;
  }

  if (consentGranted) {
    let cookieValues = [];
    const cookieMUID = getCookieValues('_uet_ss_MUID')[0];
    if (cookieMUID) {
      cookieValues.push('MUID='+ cookieMUID);
    }
    const cookieMSPTC = getCookieValues('_uet_ss_MSPTC')[0];
    if (cookieMSPTC) {
      cookieValues.push('MSPTC='+ cookieMSPTC);
    }
    if (cookieValues.length > 0) {
      headersToSend.cookie = cookieValues.join(';') +';';
    }
  }

  return sendHttpGet(endpoint, {
    headers: headersToSend,
    timeout: 1000,
  }).then((result) => {
    if (result.statusCode >= 200 && result.statusCode < 300) {
      if (consentGranted) {
        processSetCookiesHeaders(result.headers);
      }    
      data.gtmOnSuccess();
    } else {
      logToConsole('Error: ' + result.statusCode);
      data.gtmOnFailure();
    }
  });
} else {
  data.gtmOnSuccess();
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://bat.bing.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_event_data",
        "versionId": "1"
      },
      "param": [
        {
          "key": "eventDataAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "_uetmsclkid"
              },
              {
                "type": 1,
                "string": "_uetsid"
              },
              {
                "type": 1,
                "string": "_uetvid"
              },
              {
                "type": 1,
                "string": "_uet_ss_MUID"
              },
              {
                "type": 1,
                "string": "_uet_ss_MSPTC"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uetmsclkid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uetvid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uetsid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uet_ss_MUID"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_uet_ss_MSPTC"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "headerWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-user-has-adblocker"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-consent-personalized-ads"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-user-hashed-email"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-user-ip"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-site-domain"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-gdpr-applies"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-cookieless-id-domain-specific"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "referer"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-server-domain"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "accept"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "accept-encoding"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "accept-language"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-device-user-agent"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "user-agent"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "origin"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "forwarded"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "host"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-site-host"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtm-helper-server-host"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "x-forwarded-proto"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "queryParametersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "remoteAddressAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "headersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "queryParameterWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "queryParameter"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gcs"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel_from_browser",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://bat.bing.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 4/27/2024, 12:10:56 PM


